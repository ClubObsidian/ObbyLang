plugins {
    id 'java-library'
    id 'com.github.johnrengelman.shadow' version '7.0.0'
    id "net.kyori.blossom" version "1.3.0"
}

blossom{
    replaceTokenIn('com/clubobsidian/obbylang/velocity/plugin/VelocityObbyLangPlugin.java')
    replaceToken('${pluginVersion}', project.version)
}

tasks.withType(AbstractArchiveTask) {
    preserveFileTimestamps = false
    reproducibleFileOrder = true
}

shadowJar {
    baseName = 'ObbyLangVelocity'
    classifier = null

    relocate 'afu', 'com.clubobsidian.obbylang.afu'
    relocate 'io.netty', 'com.clubobsidian.obbylang.netty'
    relocate 'javassist', 'com.clubobsidian.obbylang.javassist'
    relocate 'io.lettuce.core', 'com.clubobsidian.obbylang.io.lettuce.core'
    relocate 'org.apache.commons.io', 'com.clubobsidian.obbylang.commons.io'
    relocate 'com.typesafe', 'com.clubobsidian.obbylang.typesafe'
    relocate 'com.zaxxer', 'com.clubobsidian.obbylang.zaxxer'
    relocate 'com.fasterxml', 'com.clubobsidian.obbylang.fasterxml'
    relocate 'org.jsoup', 'com.clubobsidian.obbylang.jsoup'
    relocate 'reactor', 'com.clubobsidian.obbylang.reactor'
    relocate 'org.apache', 'com.clubobsidian.obbylang.apache'
    relocate 'org.aopalliance', 'com.clubobsidian.obbylang.aopalliance'
    relocate 'org.checkerframework', 'com.clubobsidian.obbylang.checkerframework'
    relocate 'org.codehaus', 'com.clubobsidian.obbylang.codehaus'
    relocate 'org.reactivestreams', 'com.clubobsidian.obbylang.reactivestreams'
    relocate 'org.slf4j', 'com.clubobsidian.obbylang.slf4j'
    relocate 'org.yaml.snakeyaml', 'com.clubobsidian.obbylang.snakeyaml'
    relocate 'com.clubobsidian.wrappy', 'com.clubobsidian.obbylang.wrappy'
    relocate 'org.spongepowered.configurate', 'com.clubobsidian.obbylang.configurate'
    relocate 'com.google.common', 'com.clubobsidian.obbylang.guava'
    relocate 'io.leangen', 'com.clubobsidian.obbylang.leangen'
}

dependencies {
    implementation project(':core')
    compileOnly 'com.velocitypowered:velocity-api:3.0.1'
    annotationProcessor 'com.velocitypowered:velocity-api:3.0.1'
}

